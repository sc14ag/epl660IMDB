<!doctype html>
<html lang="en">
   <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
         integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
         integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
      <title>EPL660 Project</title>
      <style type="text/css">
         .jumbotron {
         height: 300px;
         background-size: cover;
         background: url('/static/background.jpg') no-repeat 50% 50%;
         border-bottom: 1px solid #ff6a00;
         color: white;
         text-align: center;
         }
         .col-3 {
         background-color: orange;
         color: white;
         }
         #movies h2 {
         color: blue;
         }
         ul {
         list-style-type: none;
         margin: 0;
         padding: 0;
         }
         .footer {
         background-color: black;
         color: white;
         width: 100%;
         height: 100px;
         position: relative;
         }
         i {
         color: white;
         position: absolute;
         top: 50%;
         left: 50%;
         transform: translate(-50%, -50%);
         }
      </style>
   </head>
   <body>
      <div class="jumbotron jumbotron-fluid">
         <div class="container">
            <h1 class="display-4">Search engine for movies</h1>
         </div>
      </div>
      <div class="container-fluid">
         <div class="row">
            <div class="col-3">
               <h2>Genres</h2>
               <ul>
                  <li>Action</li>
                  <li>Adventure</li>
                  <li>Animation</li>
                  <li>Biography</li>
                  <li>Comedy</li>
                  <li>Crime</li>
                  <li>Documentary</li>
                  <li>Drama</li>
                  <li>Family</li>
                  <li>Fantasy</li>
                  <li>Film Noir</li>
                  <li>History</li>
                  <li>Horror</li>
                  <li>Music</li>
                  <li>Musical</li>
                  <li>Mystery</li>
                  <li>Romance</li>
                  <li>Sci-fi</li>
                  <li>Short</li>
                  <li>Sport</li>
                  <li>Superhero</li>
                  <li>Thriller</li>
                  <li>War</li>
                  <li>Western</li>
               </ul>
            </div>
            <div class="col-6">
               <form action="/searchQuery" method="post">
                  <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search"
                     id="SearchInput" name="userQuery">
                  <button class="btn btn-outline-primary my-2 my-sm-0" type="submit" id="searchBtn">Search</button>
               </form>
               <br><br>
               <div id="movies"></div>
            </div>
            <div class="col-3">
               <h2>Top 3 Movies</h2>
               <ol>
                  <li>Guardians of the Galaxy</li>
                  <li>Prometheus</li>
                  <li>Split</li>
               </ol>
               <br>
               <br>
               <h2>Recent Movies</h2>
               <ol>
                  <li>Split</li>
                  <li>Sing</li>
                  <li>Suicide Squad</li>
               </ol>
            </div>
         </div>
      </div>
      <br>
      <div class="footer">
         <i class="fas fa-copyright"> by Georgia Hadjiyiorki, Aliki Gregoriou, Elli Panagi </i>
      </div>
      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
         integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
         crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
         integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
         crossorigin="anonymous"></script>
      <script type="text/javascript">
         function storeToArray(str) {

             var res = str.split("\"");
             var movie_data = [];

             var i, j, k;

             for (i = 0; i < res.length; i++) {
                 if (i % 2 == 0) {
                     var res_str = res[i].toString();
                     var temp = res_str.split(",");
                     for (j = 0; j < temp.length; j++) {
                         if (temp[j] != "")
                             movie_data.push(temp[j]);

                     }
                 }
                 else {

                     movie_data.push(res[i]);
                 }
             }
             return movie_data;
         }


         {% if queryResultsFlask == 'empty' %}
             jQuery.get("static/IMDB-Movie-Data.csv", function (response) {
                 var data = response.split("\n");
                 var data_text = "";
                 var text = "";
                 var movies_records = [];
                 for (i = 0; i < data.length - 1; i++) {

                     movies_records.push(storeToArray(data[i]));
                     if (i != 0) {
                         data_text += "<h2>" + movies_records[i][1] + "</h2>";
                         data_text += "<p>" + movies_records[i][3] + "</p>";
                     }

                 }
                 document.getElementById("movies").innerHTML = data_text;
             });

         {% endif %}

         {% if queryResultsFlask != 'empty' %}
             var data_text = "";
             queryResults = {{ queryResultsFlask |tojson}};
             queryResultsDes = {{ queryResultsPlot|tojson }};

             for (i = 0; i < queryResults.length - 1; i++) {

                 data_text += "<h2>" + queryResults[i] + "</h2>";
                 data_text += "<p>" + queryResultsDes[i] + "</p>";
             }
             document.getElementById("movies").innerHTML = data_text;

         {% endif %}
      </script>
   </body>
</html>